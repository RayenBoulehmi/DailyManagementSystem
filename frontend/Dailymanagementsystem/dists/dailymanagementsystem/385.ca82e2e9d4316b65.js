"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[385],{9385:(Ge,b,c)=>{c.r(b),c.d(b,{UserManagementModule:()=>Ke});var p=c(9808),o=c(2382),f=c(2529),i=c(1223),I=c(1398),d=c(9783);function k(t,l){1&t&&i.GkF(0)}function E(t,l){if(1&t&&(i.TgZ(0,"div",3),i.YNc(1,k,1,0,"ng-container",4),i.qZA()),2&t){const e=i.oxw();i.xp6(1),i.Q6J("ngTemplateOutlet",e.leftTemplate)}}function D(t,l){1&t&&i.GkF(0)}function M(t,l){if(1&t&&(i.TgZ(0,"div",5),i.YNc(1,D,1,0,"ng-container",4),i.qZA()),2&t){const e=i.oxw();i.xp6(1),i.Q6J("ngTemplateOutlet",e.rightTemplate)}}const A=["*"];let z=(()=>{class t{constructor(e){this.el=e}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"left":this.leftTemplate=e.template;break;case"right":this.rightTemplate=e.template}})}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(i.SBq))},t.\u0275cmp=i.Xpm({type:t,selectors:[["p-toolbar"]],contentQueries:function(e,n,r){if(1&e&&i.Suo(r,d.jx,4),2&e){let a;i.iGM(a=i.CRH())&&(n.templates=a)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:A,decls:4,vars:6,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-group-left",4,"ngIf"],["class","p-toolbar-group-right",4,"ngIf"],[1,"p-toolbar-group-left"],[4,"ngTemplateOutlet"],[1,"p-toolbar-group-right"]],template:function(e,n){1&e&&(i.F$t(),i.TgZ(0,"div",0),i.Hsn(1),i.YNc(2,E,2,1,"div",1),i.YNc(3,M,2,1,"div",2),i.qZA()),2&e&&(i.Tol(n.styleClass),i.Q6J("ngClass","p-toolbar p-component")("ngStyle",n.style),i.xp6(2),i.Q6J("ngIf",n.leftTemplate),i.xp6(1),i.Q6J("ngIf",n.rightTemplate))},dependencies:[p.mk,p.O5,p.tP,p.PC],styles:[".p-toolbar{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.p-toolbar-group-left,.p-toolbar-group-right{display:flex;align-items:center}\n"],encapsulation:2,changeDetection:0}),t})(),P=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez]}),t})();var _=c(845),x=c(1424),y=c(5315),T=c(4255),C=c(4036);function F(t,l){1&t&&(i.TgZ(0,"tr")(1,"th"),i._uU(2,"Username"),i.qZA(),i.TgZ(3,"th"),i._uU(4,"Email"),i.qZA(),i.TgZ(5,"th"),i._uU(6,"Role"),i.qZA(),i.TgZ(7,"th"),i._uU(8,"First Name"),i.qZA(),i.TgZ(9,"th"),i._uU(10,"Last Name"),i.qZA(),i.TgZ(11,"th"),i._uU(12,"Address"),i.qZA(),i.TgZ(13,"th"),i._uU(14,"Phone Number"),i.qZA(),i.TgZ(15,"th"),i._uU(16,"Actions"),i.qZA()())}function L(t,l){if(1&t){const e=i.EpF();i.TgZ(0,"tr")(1,"td"),i._uU(2),i.qZA(),i.TgZ(3,"td"),i._uU(4),i.qZA(),i.TgZ(5,"td"),i._uU(6),i.qZA(),i.TgZ(7,"td"),i._uU(8),i.qZA(),i.TgZ(9,"td"),i._uU(10),i.qZA(),i.TgZ(11,"td"),i._uU(12),i.qZA(),i.TgZ(13,"td"),i._uU(14),i.qZA(),i.TgZ(15,"td")(16,"button",32),i.NdJ("click",function(){const a=i.CHM(e).$implicit,s=i.oxw();return i.KtG(s.editUser(a))}),i.qZA(),i.TgZ(17,"button",33),i.NdJ("click",function(){const a=i.CHM(e).$implicit,s=i.oxw();return i.KtG(s.deleteUser(a.id))}),i.qZA()()()}if(2&t){const e=l.$implicit;i.xp6(2),i.Oqu(e.username),i.xp6(2),i.Oqu(e.email),i.xp6(2),i.Oqu(e.roles[0].name),i.xp6(2),i.Oqu(e.firstName),i.xp6(2),i.Oqu(e.lastName),i.xp6(2),i.Oqu(e.address),i.xp6(2),i.Oqu(e.phoneNumber)}}function O(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"Username must not contain special characters."),i.qZA())}function Z(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"Username is required."),i.qZA())}function U(t,l){if(1&t&&(i.TgZ(0,"div",34),i.YNc(1,O,2,0,"small",35),i.YNc(2,Z,2,0,"small",35),i.qZA()),2&t){const e=i.oxw();let n,r;i.xp6(1),i.Q6J("ngIf",null==(n=e.userForm.get("username"))||null==n.errors?null:n.errors.pattern),i.xp6(1),i.Q6J("ngIf",null==(r=e.userForm.get("username"))||null==r.errors?null:r.errors.required)}}function V(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"Email is required."),i.qZA())}function N(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"Invalid email format."),i.qZA())}function R(t,l){if(1&t&&(i.TgZ(0,"div",34),i.YNc(1,V,2,0,"small",35),i.YNc(2,N,2,0,"small",35),i.qZA()),2&t){const e=i.oxw();let n,r;i.xp6(1),i.Q6J("ngIf",null==(n=e.userForm.get("email"))||null==n.errors?null:n.errors.required),i.xp6(1),i.Q6J("ngIf",null==(r=e.userForm.get("email"))||null==r.errors?null:r.errors.email)}}function q(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"Password is required."),i.qZA())}function B(t,l){if(1&t&&(i.TgZ(0,"div",34),i.YNc(1,q,2,0,"small",35),i.qZA()),2&t){const e=i.oxw();let n;i.xp6(1),i.Q6J("ngIf",null==(n=e.userForm.get("password"))||null==n.errors?null:n.errors.required)}}function Q(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"First Name is required."),i.qZA())}function H(t,l){if(1&t&&(i.TgZ(0,"div",34),i.YNc(1,Q,2,0,"small",35),i.qZA()),2&t){const e=i.oxw();let n;i.xp6(1),i.Q6J("ngIf",null==(n=e.userForm.get("firstName"))||null==n.errors?null:n.errors.required)}}function j(t,l){1&t&&(i.TgZ(0,"small"),i._uU(1,"Last Name is required."),i.qZA())}function $(t,l){if(1&t&&(i.TgZ(0,"div",34),i.YNc(1,j,2,0,"small",35),i.qZA()),2&t){const e=i.oxw();let n;i.xp6(1),i.Q6J("ngIf",null==(n=e.userForm.get("lastName"))||null==n.errors?null:n.errors.required)}}function J(t,l){1&t&&(i.TgZ(0,"div",34)(1,"small"),i._uU(2,"At least one role must be selected."),i.qZA()())}const Y=function(){return{width:"50vw"}};let W=(()=>{class t{constructor(e,n){this.usersService=e,this.fb=n,this.isEditing=!1,this.displayEditUser=!1,this.roles=["ROLE_ADMIN","ROLE_USER"],this.users=[],this.selectedUser=this.initializeUser(),this.userForm=this.fb.group({username:["",[o.kI.required,o.kI.pattern(/^[a-zA-Z0-9]+$/)]],email:["",[o.kI.required,o.kI.email]],password:["",[o.kI.required]],firstName:["",[o.kI.required]],lastName:["",[o.kI.required]],address:["",[o.kI.required]],phoneNumber:["",[o.kI.required]],roles:[[],[o.kI.required]]})}ngOnInit(){this.loadUsers()}initializeUser(){return{id:0,username:"",email:"",password:"",firstName:"",lastName:"",address:"",phoneNumber:"",roles:[]}}loadUsers(){this.usersService.getAllUsers().subscribe(e=>{this.users=e.data.users,console.log(this.users)})}showNewUserDialog(){this.isEditing=!1,this.selectedUser=this.initializeUser(),this.displayEditUser=!0}editUser(e){this.isEditing=!0,this.selectedUser=Object.assign({},e),this.userForm.patchValue(this.selectedUser),this.displayEditUser=!0}deleteUser(e){confirm("Are you sure you want to delete this user?")&&this.usersService.deleteUser(e).subscribe(n=>{alert(n.message),this.loadUsers()},n=>{alert(n.message)})}saveUser(){if(this.userForm.invalid)return void alert("Please fill in all required fields correctly.");const e=Object.assign(Object.assign({},this.userForm.value),{id:this.selectedUser.id,roles:Array.isArray(this.userForm.value.roles)?this.userForm.value.roles:[this.userForm.value.roles]});0===this.selectedUser.id?this.usersService.createUser(e).subscribe(n=>{alert(n.message),this.loadUsers(),this.displayEditUser=!1},n=>{alert(n.message)}):this.usersService.updateUser(e).subscribe(n=>{alert(n.message),this.loadUsers(),this.displayEditUser=!1},n=>{alert(n.message)})}noSpecialChars(e){return e.value&&!/^[a-zA-Z0-9]*$/.test(e.value)?{invalidUsername:!0}:null}hasError(e,n){return this.userForm.controls[e].hasError(n)}}return t.\u0275fac=function(e){return new(e||t)(i.Y36(I.K),i.Y36(o.qu))},t.\u0275cmp=i.Xpm({type:t,selectors:[["ng-component"]],decls:59,vars:18,consts:[[1,"grid"],[1,"col-12"],[1,"card"],[1,"p-toolbar-group-left","flex","flex-wrap"],["pButton","","type","button","label","New","icon","pi pi-plus",1,"mr-2",3,"click"],[1,"col-12","md:col-12"],[3,"value","paginator","rows","responsiveLayout"],["pTemplate","header"],["pTemplate","body"],[3,"visible","modal","header","visibleChange"],[3,"formGroup","ngSubmit"],[1,"p-fluid"],[1,"p-field"],["for","username"],["id","username","formControlName","username","type","text","pInputText",""],["class","p-error",4,"ngIf"],["for","email"],["id","email","formControlName","email","type","text","pInputText",""],["for","password"],["id","password","formControlName","password","type","password","pInputText",""],["for","firstName"],["id","firstName","formControlName","firstName","type","text","pInputText",""],["for","lastName"],["id","lastName","formControlName","lastName","type","text","pInputText",""],["for","address"],["id","address","formControlName","address","type","text","pInputText",""],["for","phoneNumber"],["id","phoneNumber","formControlName","phoneNumber","type","text","pInputText",""],["for","role"],["id","role","formControlName","roles","placeholder","Select a Role",3,"options"],["pButton","","label","Save","icon","pi pi-check","type","submit"],["pButton","","label","Cancel","icon","pi pi-times",3,"click"],["pButton","","icon","pi pi-pencil",1,"p-button-warning","mr-2","mb-2",3,"click"],["pButton","","icon","pi pi-trash",1,"p-button-danger","mr-2","mb-2",3,"click"],[1,"p-error"],[4,"ngIf"]],template:function(e,n){if(1&e&&(i.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),i._uU(4,"Users Manager"),i.qZA(),i.TgZ(5,"p-toolbar")(6,"div",3)(7,"button",4),i.NdJ("click",function(){return n.showNewUserDialog()}),i.qZA()()()()(),i.TgZ(8,"div",5)(9,"div",2)(10,"h5"),i._uU(11,"List of Users"),i.qZA(),i.TgZ(12,"p-table",6),i.YNc(13,F,17,0,"ng-template",7),i.YNc(14,L,18,7,"ng-template",8),i.qZA()()()(),i.TgZ(15,"p-dialog",9),i.NdJ("visibleChange",function(a){return n.displayEditUser=a}),i.TgZ(16,"form",10),i.NdJ("ngSubmit",function(){return n.saveUser()}),i.TgZ(17,"div",11)(18,"div",12)(19,"label",13),i._uU(20,"Username"),i.qZA(),i._UZ(21,"input",14),i.YNc(22,U,3,2,"div",15),i.qZA(),i.TgZ(23,"div",12)(24,"label",16),i._uU(25,"Email"),i.qZA(),i._UZ(26,"input",17),i.YNc(27,R,3,2,"div",15),i.qZA(),i.TgZ(28,"div",12)(29,"label",18),i._uU(30,"Password"),i.qZA(),i._UZ(31,"input",19),i.YNc(32,B,2,1,"div",15),i.qZA(),i.TgZ(33,"div",12)(34,"label",20),i._uU(35,"First Name"),i.qZA(),i._UZ(36,"input",21),i.YNc(37,H,2,1,"div",15),i.qZA(),i.TgZ(38,"div",12)(39,"label",22),i._uU(40,"Last Name"),i.qZA(),i._UZ(41,"input",23),i.YNc(42,$,2,1,"div",15),i.qZA(),i.TgZ(43,"div",12)(44,"label",24),i._uU(45,"Address"),i.qZA(),i._UZ(46,"input",25),i.qZA(),i.TgZ(47,"div",12)(48,"label",26),i._uU(49,"Phone Number"),i.qZA(),i._UZ(50,"input",27),i.qZA(),i.TgZ(51,"div",12)(52,"label",28),i._uU(53,"Role"),i.qZA(),i._UZ(54,"p-dropdown",29),i.YNc(55,J,3,0,"div",15),i.qZA()(),i.TgZ(56,"p-footer"),i._UZ(57,"button",30),i.TgZ(58,"button",31),i.NdJ("click",function(){return n.displayEditUser=!1}),i.qZA()()()()),2&e){let r,a,s,u,m,h;i.xp6(12),i.Q6J("value",n.users)("paginator",!0)("rows",10)("responsiveLayout","scroll"),i.xp6(3),i.Akn(i.DdM(17,Y)),i.Q6J("visible",n.displayEditUser)("modal",!0)("header",n.isEditing?"Edit User":"Add User"),i.xp6(1),i.Q6J("formGroup",n.userForm),i.xp6(6),i.Q6J("ngIf",(null==(r=n.userForm.get("username"))?null:r.invalid)&&((null==(r=n.userForm.get("username"))?null:r.touched)||(null==(r=n.userForm.get("username"))?null:r.dirty))),i.xp6(5),i.Q6J("ngIf",(null==(a=n.userForm.get("email"))?null:a.invalid)&&((null==(a=n.userForm.get("email"))?null:a.touched)||(null==(a=n.userForm.get("email"))?null:a.dirty))),i.xp6(5),i.Q6J("ngIf",(null==(s=n.userForm.get("password"))?null:s.invalid)&&((null==(s=n.userForm.get("password"))?null:s.touched)||(null==(s=n.userForm.get("password"))?null:s.dirty))),i.xp6(5),i.Q6J("ngIf",(null==(u=n.userForm.get("firstName"))?null:u.invalid)&&((null==(u=n.userForm.get("firstName"))?null:u.touched)||(null==(u=n.userForm.get("firstName"))?null:u.dirty))),i.xp6(5),i.Q6J("ngIf",(null==(m=n.userForm.get("lastName"))?null:m.invalid)&&((null==(m=n.userForm.get("lastName"))?null:m.touched)||(null==(m=n.userForm.get("lastName"))?null:m.dirty))),i.xp6(12),i.Q6J("options",n.roles),i.xp6(1),i.Q6J("ngIf",(null==(h=n.userForm.get("roles"))?null:h.invalid)&&((null==(h=n.userForm.get("roles"))?null:h.touched)||(null==(h=n.userForm.get("roles"))?null:h.dirty)))}},dependencies:[p.O5,o._Y,o.Fj,o.JJ,o.JL,z,_.Hq,d.$_,d.jx,x.o,y.V,T.iA,C.Lt,o.sg,o.u],encapsulation:2}),t})(),K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[f.Bz.forChild([{path:"",component:W}]),f.Bz]}),t})();var g=c(5787),v=c(4119);let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,f.Bz,g.T,v.z,f.Bz,v.z]}),t})(),xe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,_.hJ,S,_.hJ,S]}),t})(),Te=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,d.m8]}),t})(),ze=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,d.m8,v.z,g.T,d.m8]}),t})(),Ze=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,g.T,d.m8]}),t})();var Ue=c(1874);let Ve=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez]}),t})(),qe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,d.m8]}),t})(),We=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,d.m8,g.T,d.m8]}),t})(),Ke=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=i.oAB({type:t}),t.\u0275inj=i.cJS({imports:[p.ez,o.u5,K,P,_.hJ,g.T,xe,Te,ze,Ze,Ue.$9,x.j,Ve,qe,We,y.S,_.hJ,T.U$,C.kW,o.UX]}),t})()}}]);